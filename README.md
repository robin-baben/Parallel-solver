# Parallel solvers
Здесь представлены проекты, выполненные в рамках курса ***Параллельные методы решения задач***, читаемого студентам 1 курса магистратуры филиала МГУ им. М.В. Ломоносова в городе Сарове.

Операционная система  Ubuntu 22.04.4 LTS on Windows 10 x86_64

### Задание:
**Многопоточная реализация операций с сеточными
данными на неструктурированной смешанной сетке, параллельный решатель СЛАУ средствами [OpenMP](https://www.openmp.org/), [MPI](https://www.open-mpi.org/), [OpenCL](https://www.khronos.org/opencl/).**

### Основные этапы:
- **Генерация сетки**

Строится  двумерная смешанно-элементная сетка на основе решетки, размера *Nx* на *Ny*. Нумерация узлов и клеток - слева направо, сверху вниз. Сеточные элементы - треугольники или четырехугольники. Клетки решетки делятся или не делятся на треугольники в соотношении, определяемом параметрами *k3*, *k4* (*k3* клеток делятся на треугольники, *k4* клеток не делятся (остаются четырехугольниками), и так по всем клеткам). На выходе - топология сетки в формате CSR, описывающая из каких узлов состоят элементы.

*Nx, Ny, k3, k4* являются входными параметрами от пользователя

- **Построение смежности**

На основе топологии элементы-узлы строится топология смежности узлов через элементы

- **Построение матрицы**

Заполняется симметричная разреженная матрица с диагональным преобладанием в формате CSR, портрет матрицы соответствует портрету смежности, который дополнен главной диагональю. Значения элементов матрицы вычисляются по формуле:

$$a_{ij}=cos(i+j+i*j), \\; i\not=j, \\; j \in Col(i)$$

где $Col(i)$ - множество номеров столбцов для строки $i$, которые входят в портрет матрицы.\
Диагональный элемент в каждой строке вычисляется как сумму модулей внедиагональных элементов строки, умноженная на больший единицы коэффициент:

$$ a_{ii}=\sum\limits_{j, \, j\not=i} \lvert a_{ij} \rvert$$

Заполняется вектор правой части:

$$b_i=sin(i)$$



- **Решение СЛАУ**

Реализация итерационного метода сопряженных градиентов с диагональным предобуславливателем с заданной точностью *eps*, которая явялется входным параметром от пользователя.

### Программные коды

- [**OpenMP**](https://github.com/robin-baben/Parallel-solver/tree/15b60cefb2748a7044ac09d11694dd1f686748eb/OpenMP)

Распараллелены ресурсоемкие операции метода сопряженных градиентов: матрично-векторное произведение, скалярное произведение векторов и т.д.

- [**OpenMP with NUMA**](https://github.com/robin-baben/Parallel-solver/tree/e276f57f069eb58a26b40732b000847f3547d8c3/OpenMP_with_Numa_placement)

К распараллелилавинию средствами **OpenMP** добавлена привязка потоков к ядрам(*affinity*), для избежания миграции, а также сделан *NUMA placement* - инициализация данных с той нити, которая этими данными будет пользоваться.

- [**MPI**](https://github.com/robin-baben/Parallel-solver/tree/e276f57f069eb58a26b40732b000847f3547d8c3/MPI)

Произведено распараллеливание средствами **MPI** для числа потоков $P= p*p$, где $p$ - целое положительное число. Сделана декомпозиция области, работа распределена по полученным подобластям, локализованы нумерации сеточных объектов, а также построена схема обмена данными. Операции обменов дополнительно ускорены с помощью **OpenMP**.

- [**OpenCL**](https://github.com/robin-baben/Parallel-solver/tree/e276f57f069eb58a26b40732b000847f3547d8c3/OpenCL)

Средствами **OpenCL** распараллелены ресурсоемкие операции метода сопряженных градиентов: матрично-векторное произведение, скалярное произведение векторов и т.д.



    
    
